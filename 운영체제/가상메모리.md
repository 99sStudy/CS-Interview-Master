# ✨ 가상 메모리에 대해서 설명해주세요

가상 메모리(virtual memory)는 OS에서 사용되는 `메모리 관리 기법`의 하나로 `컴퓨터가 실제로 이용가능한 메모리 자원(실제주소, physical address)을 추상화`하여 이를 사용하는
사용자들에게 `매우 큰 메모리로 보이게 만드는 것`을 말합니다.

## 🔁꼬리질문

### 🤔가상 메모리가 탄생하게 된 배경에 대해 설명해주세요.

`실행되는 코드의 전부를 물리 메모리에 존재`시켜야 했고, `메모리 용량보다 큰 프로그램은 실행시킬 수 없었습니다.`
또한 멀티 프로세스상에서 여러 프로그램을 동시에 메모리에 올리기에는 `용량의 한계`와, `페이지 교체등의 성능 이슈`가 발생했기 때문입니다.

### 🤔 가상메모리가 왜 필요한건가요?

`주기억장치의 효율적 관리`와 `메모리 관리 단순화`, `메모리 용량 및 안정성 보장` 등이있습니다.

#### 주기억장치의 효율적 관리

하드디스크를 주기억장치에 대한 캐시로설정하여, 당장 사용하는 영역만 유지하고 쓰지 않는 데이터는 하드디스크로 옮긴 뒤, 필요할 때만 램에 데이터를 불러와 올리고 다시 사용하지 않으면 하드디스크로 내림으로써 램을 효과적으로 관리하게 됩니다.

#### 메모리 관리의 단순화

각 프로세스마다 가상메모리의 통일된 주소 공간을 배정할 수 있으므로 메모리 관리가
단순해집니다.

#### 메모리 용량 및 안정성 보장

한정된 공간의 램이 아닌 거의 무한한 가상메모리 공간을 배정함으로써 프로세스들끼리
메모리 침범이 일어날 여지를 크게 줄이게 됩니다.

### 🤔 요구 페이징 (Demand Paging)이란 무엇인가요?

프로그램 실행 시작 시에 `프로그램 전체를 디스크에서 물리 메모리에 적재하는 대신` , `초기에 필요한 것들만 적재하는 전략`을 의미합니다.

가상 메모리 시스템에서 많이 사용합니다.

요구 페이징을 사용하는 가상 메모리에서는 실행과정에서 필요해질 때 페이지들이 적재됩니다.

### 🤔 페이지 폴트에 대해서 설명해주세요.

가상메모리는 작은 메모리를 매우 큰 메모리로 보이게끔 하는 것이기 때문에 참조하려는 메모리 영역이 실제에는 없을 수도 있습니다.
즉, `가상메모리에는 존재하지만 실제 메모리인 RAM에는 현재 없는 데이터나 코드에 접근할 경우`가 있으며 이 때 `페이지 폴트`가 발생합니다.

이 때 메모리의 당장 사용하지 않는 영역을 하드디스크로 옮기고 하드디스크의 일부분을
“마치 메모리처럼” 불러와 쓰는 것을 `스와핑`이라고 합니다.

### 스와핑이란 무엇인가요?

메모리의 관리를 위해 사용되는 기법입니다.
`CPU 할당 시간이 끝난 프로세스의 메모리`를 `보조기억장치(하드디스크)로 내보내고 다른 프로세스를 메모리로 불러 들이는 것`을 의미합니다.

```
swap-in: 주 기억장치(RAM)으로 불러오는 과정
swap-out: 보조 기억장치로 내보내는 과정
swap에는 큰 디스크 전송시간이 필요하기 때문에 현재에는 메모리 공간이 부족할 때 Swapping이 시작됩니다.
```

### 🤔페이지 히트와 페이지 미스에 대해서 설명해주세요.

#### 페이지 히트(Page Hit)

페이지 히트는 프로세스가 요청한 해당 페이지가 이미 메모리에 적재되어 있어 바로 접근할
수 있는 상황을 말합니다.

#### 페이지 미스(Page Miss)

페이지 미스는 프로세스가 요청한 해당 페이지가 메모리에 없는 상황을 말합니다.

### 🤔페이지 미스와 페이지 폴트의 차이점에 대해서 설명해주세요.

페이지 미스는 종종 페이지 폴트를 초래할 수 있습니다.

페이지 폴트는 요청된 페이지가 메모리에 없어 운영체제가 보조 저장 장치에서 해당 페이지를 메모리로 로드해야 하는 상황을 의미합니다.

모든 페이지 폴트는 페이지 미스로 인해 발생하지만, 모든 페이지 미스가 페이지 폴트로 이어지는 것은 아닙니다.

다음의 경우는 페이지미스가 나지만 페이지폴트로 이어지지 않습니다.

```
1. 접근 권한 오류
해당 페이지에 대한 접근 권한이 없거나 잘못된 접근(예: 쓰기 금지된 페이지에 쓰기 시도)이
시도되었을 경우 운영체제는 이를 오류로 처리하고 해당 요청을 거부합니다.
이 경우 페이지미스가 발생하지만 실제로 페이지를 메모리로 로드하지 않고, 접근 권한 위반
오류를 발생시키므로 페이지 폴트로 이어지지 않습니다.

2. 성능최적화를 위해 미리 로드할 때의 페이지 미스
어떤 시스템 또는 운영체제에서 성능최적화를 위해 페이지를 실제로 사용하기 전에 미리
요청(프리페칭)하는 최적화 기법을 사용하기도 합니다. 이 때 실제 데이터 사용 전에 다른
데이터로 덮어쓰게 될 경우 페이지 미스는 발생하지만, 사용되지 않아 페이지 폴트로는
발전하지 않습니다.
```

### 🤔 페이지 폴트 과정에 대해서 설명해주세요.

1. 어떤 명령어가 유효한 가상주소에 접근했으나 해당 페이지가 만약 없다면 트랩이
   발생되어 `운영체제에 알리게 됩니다.`
2. 운영체제는 실제 디스크로부터 `사용하지 않은 프레임을 찾습니다.`
3. 해당 프레임을 실제 메모리에 가져와서 페이지교체알고리즘을 기반으로 특정페이지와
   교체합니다. (이 때 스와핑이 일어납니다.)
4. 페이지테이블을 갱신시킨 후 해당 명령어를 다시 시작합니다.

### 🤔 페이지가 무엇인가요?

가상 메모리를 사용하는 최소 크기 단위입니다.

### 페이지 테이블이란 무엇인가요?

### 🤔 스레싱에 대해서 설명해주세요.

스레싱은 `메모리의 페이지 폴트율이 높은 것을 의미`합니다.

스레싱은 `메모리에 너무 많은 프로세스가 동시에 올라가게 되면 스와핑이 많이 일어나서 발생`합니다.

페이지폴트가 일어나면 CPU 이용률은 낮아집니다.

CPU 이용률은 낮아지게 되면 운영체제는 CPU의 가용성을 높이기 위해 더 많은 프로세스를 메모리에 올리게 됩니다.

이러한 `악순환이 반복`되어 스레싱이 일어나게 됩니다.

### 🤔 스레싱을 해결하는 방법에 대해서 아는대로 설명해주세요

이를 하드웨어적으로 해결하는 방법으로는 `메모리를 늘리`거나 HDD를 사용한다면 `HDD를 SSD로 바꾸는 방법`이 있으며 운영체제에서 해결하는 방법은 `작업세트`와 `PFF`가 있습니다.
