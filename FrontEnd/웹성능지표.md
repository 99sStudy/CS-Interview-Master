# ✨웹 성능을 최적화하기 위한 핵심 지표(LCP, FID, CLS 등)에 대해 설명하고, 이러한 지표를 개선하기 위해 프로젝트에서 어떤 방법들을 사용했는지 구체적인 사례를 들어 설명해 주세요.

웹 성능 최적화는 사용자 경험을 향상시키고, 검색 엔진 최적화(SEO)에 긍정적인 영향을 미치는 중요한 요소입니다.

## 1. 핵심 지표

### FP (First Paint) [렌더링 관련 지표]

- 정의 :Paint timing API 에서 제공. `페이지로 이동한 시각부터 첫 번째 픽셀이 화면에 그려지기까지 사이의 시간`을 나타낸다.

### FCP (First Contentful Paint) [렌더링 관련 지표]

- 정의 : 사용자가 웹페이지 로딩을 시작할 때부터 페이지 콘텐츠의 일부가 화면에 렌더링될 때까지 걸리는 시간
- 이 콘텐츠에는 `텍스트, 이미지, SVG 또는 컬러 캔버스 요소`가 포함될 수 있습니다.
- 유저가 처음으로 컨텐츠를 소비하기 시작하는 시간이다.
- 우수한 사용자 경험을 제공하려면 FCP는 1.8초 이하여야 한다.
- FCP를 최적화하기 위한 방법으로 `렌더링 차단 리소스 제거`, `CSS 축소`, `핵심 요청 사전 로드`, `캐시 활용`, `요청 깊이 최소화` 등이 있다.
- FCP를 개선하려면 다음 전략을 고려하세요:
  - 서버 응답 시간 최적화: 서버가 요청에 빠르게 응답하는지 확인하세요.
  - 렌더링을 차단하는 리소스를 최소화합니다: 렌더링을 차단하는 JavaScript 및 CSS를 연기하거나 제거합니다.
  - CSS 및 자바스크립트 최적화: 이러한 파일을 축소 및 압축하여 크기를 줄이고 로딩 시간을 개선하세요.
  - 주요 리소스 미리 로드하기: 중요한 리소스의 로드 우선순위를 지정하려면 <link rel="preload">를 사용하세요.
  - CDN(콘텐츠 전송 네트워크)을 사용합니다: 여러 서버에 콘텐츠를 분산하여 전 세계 사용자의 로드 시간을 개선하세요

### 📖LCP (Largest Contentful Paint) [렌더링 관련 지표]

- 정의: 페이지에서 `가장 큰 콘텐츠 요소(예: 이미지, 비디오, 텍스트 블록)가 사용자에게 렌더링되는 데 걸리는 시간을 측정`합니다.
- 중요성: LCP는 사용자에게 페이지가 로드되고 있음을 인식할 수 있는 중요한 지표입니다. LCP가 2.5초 이하일 때 좋은 성능으로 간주됩니다.

### TTI (Time to Interactive)

- 정의 : `페이지가 로드되기 시작`한 시점부터 주요 하위 리소스가 로드된 후 `사용자 입력에 안정적으로 응답할 수 있게 되기까지`의 시간이다.
- SSR과 같은 기술을 사용하면 표시 속도는 빨라지지만 TTI가 희생될 수 있다.

### 📖FID (First Input Delay) [반응 속도 관련 지표]

- 정의: 사용자가 페이지와 `상호작용을 시작한 후, 브라우저가 실제로 반응하기까지의 시간을 측정`합니다. 예를 들어, 버튼 클릭이나 링크 클릭 시의 지연 시간을 측정합니다.
- 중요성: FID는 사용자 경험의 즉각성을 나타내며, 100ms 이하일 때 좋은 성능으로 간주됩니다.

### FID의 한계점

2020년 구글에서 Web Core Vitals 지표 발표 이후 Web Core Vitals의 3대 지표 중 하나인 FID 지표에는 한계점이 존재했습니다.

즉, 사용자는 `첫번째 입력값 뿐만 아니라 사용자의 모든 입력 반응성을 반영하지 못했습니다`.

이에 구글에서는 서두에 말씀드렸듯이 FID를 포괄하는 새로운 지표를 만들어 웹 성능 지표인 Web Core Vitals를 개선하고자 했습니다.

### INP의 도입 (INP : Interaction to Next Paint)

위와 같은 FID의 한계점 때문에 구글은 2024년 3월에 FID라는 지표를 대체하여 INP라는 새로운 지표를 사용하려고 합니다.

INP란 `사용자가 페이지를 방문하여 전체 기간동안 발생하는 모든 클릭, 탭, 키보드의 상호작용을 관찰하여 사용자 상호작용에 대한 페이지의 전반적인 응답성을 평가하는 측정지표`입니다.

첫번째 입력뿐만 아니라 `웹사이트 사용자의 입력 반응성을 고려하는게 필요`했고, 이벤트 지연시간 뿐만 아니라 `전체시간 확인이 필요`했습니다.

그리고 이벤트 입력시간 뿐만 아니라 엔드투엔드로 사용자의 시간까지 확인하려고 합니다.

INP는 마우스 클릭 혹은 터치스크린의 경우 기기를 탭하는 경우, 키보드 입력 값의 경우의 유형만 관찰됩니다

### 📖CLS (Cumulative Layout Shift) [UI 안정성]

- 정의: 페이지의 `레이아웃이 얼마나 자주 변경되는지를 측정`합니다. 사용자가 페이지를 읽는 동안 예상치 못한 레이아웃 변경이 발생하면 사용자 경험이 저하됩니다.
- 중요성: CLS는 0.1 이하일 때 좋은 성능으로 간주되며, 레이아웃 안정성을 나타냅니다.

## 2. 지표 개선을 위한 방법과 사례

### 🚨사례 1: LCP 개선

- 문제 상황: 이미지와 비디오가 포함된 페이지에서 LCP가 3초 이상 걸리는 경우가 많았습니다.

### 개선 방법:

- 이미지 최적화:

  - 이미지 파일 크기를 줄이기 위해 `ImageKit`이나 `Cloudinary`와 같은 이미지 최적화 서비스를 사용했습니다.

  - `WebP`와 같은 현대적인 이미지 포맷을 사용하여 로딩 속도를 개선했습니다.

- 지연 로딩(Lazy Loading):

  - React의 `React.lazy`와 `Suspense`를 사용하여 화면에 보이지 않는 컴포넌트를 지연 로딩했습니다.

  - 이미지에 대해서는 `loading="lazy"` 속성을 추가하여 브라우저가 뷰포트에 들어오는 시점에만 로드하도록 했습니다.

- CDN 사용: 콘텐츠 전송 네트워크(CDN)를 사용하여 이미지와 비디오의 로딩 속도를 개선했습니다.

### 🚨사례 2: FID 개선

- 문제 상황: 페이지가 복잡한 JavaScript를 사용하고 있어 사용자 입력에 대한 반응이 느렸습니다.

### 개선 방법:

- JavaScript 최적화:

  - `불필요한 라이브러리`나 `코드 분할`을 통해 초기 로딩 시 필요한 `JavaScript의 양을 줄였습니다.`
  - React.memo와 useCallback을 사용하여 컴포넌트의 리렌더링을 최소화했습니다.

- 비동기 로딩:
  - `defer 속성을 사용`하여 외부 스크립트를 비동기적으로 로드하고, 초기 렌더링에 영향을 주지 않도록 했습니다.

### 🚨사례 3: CLS 개선

- 문제 상황: 페이지 내용이 로딩되는 동안 레이아웃이 자주 변경되어 사용자 경험이 저하되었습니다.

### 개선 방법:

- 고정된 크기 설정: 이미지와 비디오에 대해 `고정된 너비와 높이를 설정`하여 레이아웃 변경을 방지했습니다.

  ```
  <img src="image.jpg" width="600" height="400" alt="Description" />
  ```

- 글꼴 로딩 최적화: 사용자 정의 글꼴을 사용하면서도 `font-display: swap` 속성을 추가하여 페이지 로딩 시 글꼴 변경으로 - 인한 레이아웃 이동을 줄였습니다.
- 광고 공간 예약: 광고를 포함할 경우, 광고의 위치와 크기를 미리 예약하여 레이아웃 이동을 방지했습니다.
